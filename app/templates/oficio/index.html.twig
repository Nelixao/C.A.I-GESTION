{% extends 'base.html.twig' %}

{% block title %}Oficios{% endblock %}

{% block stylesheets %}{% endblock %}

{% block body %}
    <div class="container text-center">
        <h1 class="oficios-title mb-4">Listado de Oficios</h1>

        <!-- Botones principales -->
        <div class="row justify-content-end mb-3">
            <div class="col-md-2 col-6 mb-2">
                <a href="{{ path('app_oficio_export') }}" class="btn btn-success w-100">Exportar a Excel</a>
            </div>
            <div class="col-md-2 col-6 mb-2">
                <a href="{{ path('app_oficio_new') }}" class="btn btn-primary w-100">+ Crear nuevo oficio</a>
            </div>
        </div>

        <!-- Buscador -->
        <div class="row justify-content-start mb-4">
            <div class="col-md-6">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Buscar por tÃ­tulo">
                    <select class="form-select">
                        <option value="todos">Todas las etapas</option>
                        <option value="sin-etapa">Sin etapa</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Tabla -->
        <table class="table table-striped table-bordered align-middle">
            <thead class="table">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Fecha</th>
                <th scope="col">Dirigido a</th>
                <th scope="col">Asunto</th>
                <th scope="col">Contenido</th>
                <th scope="col">Elaborado por</th>
                <th scope="col">Acciones</th>
            </tr>
            </thead>
            <tbody>
            {% for oficio in oficios %}
                {% set row_text = (oficio.id ~ ' ' ~ oficio.title ~ ' ' ~ oficio.content ~ ' ' ~ oficio.sender ~ ' ' ~ oficio.recipient ~ ' ' ~ (oficio.date ? oficio.date|date('Y-m-d H:i') : '') ~ ' ' ~ oficio.filePath ~ ' ' ~ oficio.createdBy)|lower %}
                <tr data-stage="sin-etapa" data-text="{{ row_text }}" data-asunto="{{ oficio.title|lower }}">
                    <td>{{ oficio.id }}</td>
                    <td>{{ oficio.date ? oficio.date|date('d-m-Y') : '' }}</td>
                    <td>{{ oficio.recipient }}</td>
                    <td>{{ oficio.title }}</td>
                    <td>{{ oficio.content }}</td>
                    <td>{{ oficio.sender }}</td>
                    <td>
                        <a href="{{ path('app_oficio_show', {'id': oficio.id}) }}" class="btn btn-sm btn-info">Ver</a>
                        <a href="{{ path('app_oficio_edit', {'id': oficio.id}) }}" class="btn btn-sm btn-warning">Editar</a>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="7" class="text-center text-dark">
                        No hay oficios registrados
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
