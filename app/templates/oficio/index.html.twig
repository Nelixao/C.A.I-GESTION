{% extends 'base.html.twig' %}

{% block title %}Listado de Oficios{% endblock %}

{% block stylesheets %}{% endblock %}

{% block body %}
    <div class="container-oficios js-table-wrapper">
        <div class="d-flex justify-content-between align-items-center flex-wrap mb-3">
            <h1 class="oficios-title">Listado de Oficios</h1>
            <div style="display:flex; gap:10px;">
                <a href="{{ path('app_oficio_export') }}" class="create-btn" style="background-color:#4caf50;">Exportar a Excel</a>
                <a href="{{ path('app_oficio_new') }}" class="create-btn">+ Crear nuevo oficio</a>
            </div>
        </div>

        <div class="">
            <input type="text" class="js-search" placeholder="Buscar en la tabla..." style="padding:8px 10px; border:1px solid #ddd; border-radius:8px; min-width:240px;">
            <select class="js-stage" style="padding:8px 10px; border:1px solid #ddd; border-radius:8px;">
                <option value="todos">Todas las etapas</option>
                <option value="sin-etapa">Sin etapa</option>
            </select>
        </div>

        <table class="">
            <thead>
                <tr>
                    <th>No. Oficio</th>
                    <th>Fecha</th>
                      <th>Dirigido a</th>
                    <th>Asunto</th>
                    <th>Elaborado</th>
                        <th>etapa</th>
                         <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
            {% for oficio in oficios %}
                {% set row_text = (oficio.id ~ ' ' ~ oficio.title ~ ' ' ~ oficio.content ~ ' ' ~ oficio.sender ~ ' ' ~ oficio.recipient ~ ' ' ~ (oficio.date ? oficio.date|date('Y-m-d H:i') : '') ~ ' ' ~ oficio.filePath ~ ' ' ~ oficio.createdBy)|lower %}
                <tr data-stage="sin-etapa" data-text="{{ row_text }}" data-asunto="{{ oficio.title|lower }}">
                    <td>{{ oficio.id }}</td>
                    <td>{{ oficio.date ? oficio.date|date('d-m-Y') : '' }}</td>
                    <td>{{ oficio.recipient }}</td>
                    <td>{{ oficio.title }}</td>
                    <td>{{ oficio.content }}</td>
                    <td>{{ oficio.sender }}</td>
                    <td>
                        <a href="{{ path('app_oficio_show', {'id': oficio.id}) }}" class="button-link">Ver</a>
                        <a href="{{ path('app_oficio_edit', {'id': oficio.id}) }}" class="button-link">Editar</a>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td>sin info</td>

                </tr>
            {% endfor %}
            </tbody>
        </table>
        <div class="js-counter" style="margin-top:8px; color:#555; font-size:0.9rem;">&nbsp;</div>
        <a href="{{ path('app_oficio_new') }}" class="create-btn">+ Crear nuevo oficio</a>
    </div>
{% endblock %}
