{% extends 'base.html.twig' %}
{% block title %}Dashboard{% endblock %}
{% block body %}
<div class="container content">
  <div class="row mb-3 text-center">
    <h1 class="card-title dm-serif-text-regular">Bienvenida al Sistema Administrativo</h1>
    <p class="text-muted">Gestiona oficios, correspondencias, circulares y documentos escaneados</p>
  </div>

  <!-- Tarjetas principales -->
  <div class="grid mb-4">
    <div class="card">
      <div class="card-header"><span class="card-title"><i class="bi bi-file-earmark-text"></i> Oficios</span></div>
      <div class="card-content">{{ oficiosCount|default(0) }}</div>
      <p class="text-muted">Total registrados</p>
    </div>

    <div class="card">
      <div class="card-header"><span class="card-title"><i class="bi bi-arrow-repeat"></i> Circulares</span></div>
      <div class="card-content">{{ circularesCount|default(0) }}</div>
      <p class="text-muted">Total registradas</p>
    </div>

    <div class="card">
      <div class="card-header"><span class="card-title"><i class="bi bi-upc-scan"></i> Escáner</span></div>
      <div class="card-content">{{ scansCount|default(0) }}</div>
      <p class="text-muted">Documentos escaneados</p>
    </div>

    <div class="card">
      <div class="card-header"><span class="card-title"><i class="bi bi-envelope"></i> Correspondencias</span></div>
      <div class="card-content">{{ correspondencesCount|default(0) }}</div>
      <p class="text-muted">Internas y externas</p>
    </div>
  </div>

  <!-- Acciones rápidas -->
  <div class="card mb-4">
    <div class="card-header"><span class="card-title"><i class="bi bi-lightning-charge"></i> Acciones Rápidas</span></div>
    <div class="card-content quick-actions">
      <a class="button" href="{{ path('app_oficio_new') }}"><i class="bi bi-plus-circle"></i> Nuevo Oficio</a>
      <a class="button" href="{{ path('app_correspondence_new') }}"><i class="bi bi-plus-circle"></i> Nueva Correspondencia</a>
      <a class="button" href="{{ path('app_circular_new') }}"><i class="bi bi-plus-circle"></i> Nueva Circular</a>
      <a class="button" href="{{ path('app_scanner_new') }}"><i class="bi bi-upc-scan"></i> Escanear Documento</a>
    </div>
  </div>

  <!-- Actividad reciente -->
  <div class="activity">
    <div class="card">
      <div class="card-header">
        <span class="card-title"><i class="bi bi-clock-history"></i> Oficios Recientes</span>
        <a class="btn btn-outline-primary btn-sm" href="{{ path('app_oficio_index') }}">Ver todos</a>
      </div>
      <div class="card-body">
        {% if recentOficios|length > 0 %}
          {% for o in recentOficios %}
            <div class="activity-item">
              <div>#{{ o.id }} {{ o.sender|default('—') }} → {{ o.recipient|default('—') }} · {{ o.title|default('Sin título')|slice(0,50) }}</div>
              <span class="badge default">{{ o.date ? o.date|date('Y-m-d') : '—' }}</span>
            </div>
          {% endfor %}
        {% else %}
          <div class="activity-item"><div>No hay actividad reciente</div><span class="badge outline">—</span></div>
        {% endif %}
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <span class="card-title"><i class="bi bi-broadcast"></i> Circulares Activas</span>
        <a class="btn btn-outline-primary btn-sm" href="{{ path('app_circular_index') }}">Ver todas</a>
      </div>
      <div class="card-body">
        {% if activeCirculares|length > 0 %}
          {% for c in activeCirculares %}
            <div class="activity-item">
              <div>#{{ c.id }} · {{ c.title|default('Sin título')|slice(0,60) }}</div>
              <span class="badge secondary">{{ c.date ? c.date|date('Y-m-d') : '—' }}</span>
            </div>
          {% endfor %}
        {% else %}
          <div class="activity-item"><div>No hay circulares</div><span class="badge outline">—</span></div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
